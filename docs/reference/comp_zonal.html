<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>comp_zonal — comp_zonal • sprawl</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sprawl</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/IREA-CNR-MI/sprawl/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>comp_zonal</h1>
    </div>

    
    <p>Function used to extract values of a single- or multi- band raster for pixels
corresponding to the features of a vector (Polygon, Point or Line)</p>
    

    <pre class="usage"><span class='fu'>comp_zonal</span>(<span class='no'>in_rast</span>, <span class='no'>in_vect_zones</span>, <span class='kw'>selbands</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>rastres</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>id_field</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>summ_data</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>full_data</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>comp_quant</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>small</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>maxchunk</span> <span class='kw'>=</span> <span class='fl'>5e+07</span>,
  <span class='kw'>long</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>addfeat</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>addgeom</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep_null</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>in_rast</th>
      <td><p>input raster. Can be wither:</p><ol>
<li><p>A file name corresponding to a valid single- or multi- band raster (e.g. /my_folder/myfile.tif)
All <code>gdal</code> raster formats are supported</p></li>
<li><p>An <code>raster</code>, <code>rasterStack</code> or <code>rasterBrick</code> object</p></li>
</ol></td>
    </tr>
    <tr>
      <th>in_vect_zones</th>
      <td><p>input vector object containing zones from which data has to be extracted.
Can be either:</p><ol>
<li><p>A <code>file name</code> corresponding to a valid ESRI shapefile (e.g. /my_folder/myshape.shp)</p></li>
<li><p>An <code>R</code> <code>+sp</code> or <code>sf</code> object</p></li>
</ol></td>
    </tr>
    <tr>
      <th>selbands</th>
      <td><p><code>2-element numeric array</code> defining starting and ending raster bands to be processed
(e.g., c(1, 10). Default: NULL, meaining that all bands will be processed</p></td>
    </tr>
    <tr>
      <th>rastres</th>
      <td><p><code>numeric</code>, if not null, the input raster is resampled to rastres prior to
data extraction using nearest neighbour resampling. This is useful in case the polygons are small
with respect to <code>in_rast</code> resolution, Default: NULL (meaning no resampling is done)</p></td>
    </tr>
    <tr>
      <th>id_field</th>
      <td><p><code>character</code> (optional) field of the vector file to be used to identify the
zones from which data is to be extracted, If NULL (or invalid) zonal statistics are extracted on each row of the
shapefile, and a new column named <code>id_feat</code> is used on the output to distinguish the zones, Default: NULL</p></td>
    </tr>
    <tr>
      <th>summ_data</th>
      <td><p><code>logical</code> If TRUE, summary statistics of values belonging to each vector zone
are returned in <code>out$stats</code>. Default statistics are average, median, standard deviation and variation
coefficient. Quantiles of the distribution can be also returned if <code>comp_quant == TRUE</code>,  Default: TRUE</p></td>
    </tr>
    <tr>
      <th>full_data</th>
      <td><p><code>logical</code> If TRUE, values of all pixels belonging to each vector zone are returned
in `out$alldata' (Setting this to FALSE can be a good idea for large datasets....), Default: TRUE</p></td>
    </tr>
    <tr>
      <th>comp_quant</th>
      <td><p><code>logical</code> if TRUE, also quantiles of the distributions of values are computed for each zone
and returned in  <code>out$ts_summ</code>, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>small</th>
      <td><p><code>logical</code> if TRUE, values are returned also for small polygons not including any
pixel centroids. Values are taken from all cells "touched" by the small polygon, Default: TRUE</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p><code>logical</code> If TRUE, NA values are removed while computing statistics, Default: TRUE</p></td>
    </tr>
    <tr>
      <th>maxchunk</th>
      <td><p>Maximum chunk size (provisional), Default: 5e+07</p></td>
    </tr>
    <tr>
      <th>long</th>
      <td><p><code>logical</code> If TRUE, <code>out$summ_data</code> is returned in long format, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>addfeat</th>
      <td><p><code>logical</code> If TRUE, columns of the attribute table of the <code>in_vect_zones</code> layer are
joined to results of the computation, Default: TRUE</p></td>
    </tr>
    <tr>
      <th>addgeom</th>
      <td><p><code>logical</code>, If TRUE, the output sent out as an <code>sf</code> object, preserving the geometry
of <code>in_vect_zones</code>. Note that this leads to dyuplication of geometries, and may be very slow for
large datasets. Default: FALSE</p></td>
    </tr>
    <tr>
      <th>keep_null</th>
      <td><p><code>logical</code> If TRUE, the output preserves features of <code>in_vect_zones</code> falling outside
the extent of <code>in_rast</code>. Values for these features are set to NA, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code> If TRUE, messages concerning the processing status are shown in the
console, Default: TRUE</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p><code>numeric</code> maximum number of cores to be used in the processin. If NULL, defaults to
available cores - 2, but up to a maximum of 8. If user-provided is greter than available cores - 2
or greater than 8, ncores is re-set to the minimum between those two.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>out_list <code>list</code> containing two tibbles: <code>out_list$summ_data</code> contains summary statitstics,
while <code>out_list$alldata</code> contains the data of all pixels extracted (see examples).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  <span class='fu'>library</span>(<span class='no'>sprawl</span>)
  <span class='fu'>options</span>(<span class='kw'>tibble.width</span> <span class='kw'>=</span> <span class='fl'>Inf</span>)
  <span class='no'>in_rast</span>  <span class='kw'>&lt;-</span> <span class='fu'>get</span>(<span class='fu'>load</span>(<span class='fu'>system.file</span>(<span class='st'>"extdata"</span>, <span class='st'>"in_rast.rda"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sprawl"</span>)))
  <span class='no'>in_zones</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='readshape.html'>readshape</a></span>(<span class='fu'>system.file</span>(<span class='st'>"extdata"</span>,<span class='st'>"lc_polys.shp"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sprawl"</span>), <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='no'>T</span>)
  <span class='no'>stats</span>    <span class='kw'>&lt;-</span> <span class='fu'>comp_zonal</span>(<span class='no'>in_rast</span>, <span class='no'>in_zones</span>, <span class='kw'>long</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: attribute variables are assumed to be spatially constant throughout all geometries</span></div><div class='input'>  <span class='no'>stats</span></div><div class='output co'>#&gt; $stats
#&gt; Simple feature collection with 552 features and 13 fields
#&gt; geometry type:  POLYGON
#&gt; dimension:      XY
#&gt; bbox:           xmin: 12897990 ymin: 1685995 xmax: 12971590 ymax: 1780601
#&gt; epsg (SRID):    NA
#&gt; proj4string:    +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs
#&gt; # A tibble: 552 x 14
#&gt;    id_feat band_n       date    id  lc_type category sup_catego     N      avg   med       sd   min   max          geometry
#&gt;      &lt;int&gt;  &lt;dbl&gt;     &lt;date&gt; &lt;dbl&gt;   &lt;fctr&gt;   &lt;fctr&gt;     &lt;fctr&gt; &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;S3: sfc_POLYGON&gt;
#&gt;  1       1      1 2013-01-01     1 forest_1   Forest Vegetation    61 4830.820  4747 540.6097  3731  5987 &lt;S3: sfc_POLYGON&gt;
#&gt;  2       1      2 2013-01-09     1 forest_1   Forest Vegetation    61 4605.131  4648 510.8426  3665  5547 &lt;S3: sfc_POLYGON&gt;
#&gt;  3       1      3 2013-01-17     1 forest_1   Forest Vegetation    61 4837.902  4834 557.4429  3640  5827 &lt;S3: sfc_POLYGON&gt;
#&gt;  4       1      4 2013-01-25     1 forest_1   Forest Vegetation    61 4484.984  4411 473.7452  3285  5275 &lt;S3: sfc_POLYGON&gt;
#&gt;  5       1      5 2013-02-02     1 forest_1   Forest Vegetation    61 4284.197  4237 498.7366  3469  5318 &lt;S3: sfc_POLYGON&gt;
#&gt;  6       1      6 2013-02-10     1 forest_1   Forest Vegetation    61 4374.525  4302 471.1914  3317  5363 &lt;S3: sfc_POLYGON&gt;
#&gt;  7       1      7 2013-02-18     1 forest_1   Forest Vegetation    61 4113.246  4123 505.7164  2759  4991 &lt;S3: sfc_POLYGON&gt;
#&gt;  8       1      8 2013-02-26     1 forest_1   Forest Vegetation    61 4050.689  4164 785.0554  1614  5350 &lt;S3: sfc_POLYGON&gt;
#&gt;  9       1      9 2013-03-06     1 forest_1   Forest Vegetation    61 3937.738  3917 452.0158  3039  4850 &lt;S3: sfc_POLYGON&gt;
#&gt; 10       1     10 2013-03-14     1 forest_1   Forest Vegetation    61 4281.672  4282 503.7382  3143  5320 &lt;S3: sfc_POLYGON&gt;
#&gt; # ... with 542 more rows
#&gt; 
#&gt; $alldata
#&gt; Simple feature collection with 147384 features and 9 fields
#&gt; geometry type:  POINT
#&gt; dimension:      XY
#&gt; bbox:           xmin: 12897120 ymin: 1698852 xmax: 12973570 ymax: 1789198
#&gt; epsg (SRID):    NA
#&gt; proj4string:    +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs
#&gt; # A tibble: 147,384 x 10
#&gt;    mdxtnq band_n       date N_PIX    id  lc_type category sup_catego value        geometry
#&gt;     &lt;int&gt;  &lt;dbl&gt;     &lt;date&gt; &lt;int&gt; &lt;dbl&gt;   &lt;fctr&gt;   &lt;fctr&gt;     &lt;fctr&gt; &lt;dbl&gt; &lt;S3: sfc_POINT&gt;
#&gt;  1      1      1 2013-01-01     1     1 forest_1   Forest Vegetation  4454 &lt;S3: sfc_POINT&gt;
#&gt;  2      1      1 2013-01-01     2     1 forest_1   Forest Vegetation  4260 &lt;S3: sfc_POINT&gt;
#&gt;  3      1      1 2013-01-01     3     1 forest_1   Forest Vegetation  3987 &lt;S3: sfc_POINT&gt;
#&gt;  4      1      1 2013-01-01     4     1 forest_1   Forest Vegetation  4814 &lt;S3: sfc_POINT&gt;
#&gt;  5      1      1 2013-01-01     5     1 forest_1   Forest Vegetation  5242 &lt;S3: sfc_POINT&gt;
#&gt;  6      1      1 2013-01-01     6     1 forest_1   Forest Vegetation  5353 &lt;S3: sfc_POINT&gt;
#&gt;  7      1      1 2013-01-01     7     1 forest_1   Forest Vegetation  5074 &lt;S3: sfc_POINT&gt;
#&gt;  8      1      1 2013-01-01     8     1 forest_1   Forest Vegetation  4434 &lt;S3: sfc_POINT&gt;
#&gt;  9      1      1 2013-01-01     9     1 forest_1   Forest Vegetation  4224 &lt;S3: sfc_POINT&gt;
#&gt; 10      1      1 2013-01-01    10     1 forest_1   Forest Vegetation  3904 &lt;S3: sfc_POINT&gt;
#&gt; # ... with 147,374 more rows
#&gt; </div><div class='input'> </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Lorenzo Busetto, phD (2014-2015) <a href='mailto:lbusett@gmail.com'>lbusett@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Lorenzo Busetto, Luigi Ranghetti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
