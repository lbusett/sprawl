<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mask a raster based on a vector — mask_rast • sprawl</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  <link href="../extra.css" rel="stylesheet">
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84499524-3', 'auto');
  ga('send', 'pageview');

</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sprawl</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sprawl.html">Getting Started</a>
</li>
<li>
  <a href="../articles/articles/examples.html">Examples of Use</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Contributing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/contributing.html">Contributing</a>
    </li>
    <li>
      <a href="../articles/articles/coding_style.html">Coding Style</a>
    </li>
    <li>
      <a href="../articles/articles/CONDUCT.html">Code of Conduct</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    faq
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    code reference
  </a>
</li>
<li>
  <a href="https://github.com/lbusett/sprawl/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mask a raster based on a vector</h1>
    </div>

    
    <p>Masks a raster file or object on the basis of a vector file or object.
Pixels not covered by the vector features are set to NoData. If the input raster
is multi-band, the mask is automatically applied to all bands. An optional
buffer can be applied to the input vector to allow a more "lenient" masking,
or to remove also the borders of the vector.</p>
    

    <pre class="usage"><span class='fu'>mask_rast</span>(<span class='no'>in_rast</span>, <span class='no'>mask</span>, <span class='kw'>crop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>buffer</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>out_type</span> <span class='kw'>=</span> <span class='st'>"rastobject"</span>, <span class='kw'>out_filename</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>out_dtype</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>out_nodata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>compress</span> <span class='kw'>=</span> <span class='st'>"None"</span>, <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>2</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>in_rast</th>
      <td><p>Raster file or object inheriting class <code>raster</code> to be masked</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>Vector file or object of class <code>*sf</code> or <code>sp</code> to be used as a mask</p></td>
    </tr>
    <tr>
      <th>crop</th>
      <td><p><code>logical</code> if TRUE, <code>in_rast</code> is also cropped on the extent of <code>mask</code>,
Default: FALSE</p></td>
    </tr>
    <tr>
      <th>buffer</th>
      <td><p><code>numeric</code> if not NULL, width of a buffer to be applied to <code>mask</code>
before masking <code>in_rast</code>. If negative, mask is "reduced" prior to masking
(see examples), Default: NULL</p></td>
    </tr>
    <tr>
      <th>out_type</th>
      <td><p><code>character</code></p><ul>
<li><p>if == "rastobj", return a <code>Raster</code> object;</p></li>
<li><p>if == "filename", return the filename of the masked layer (GTiff or gdal vrt format
depending on other arguments - see below)
Default: "rastobj" (If an invalid string is provided, defaults to <code>rastobj</code>)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>out_filename</th>
      <td><p><code>character</code> filename where the masked raster should be saved
If NULL, the masked raster is saved on a temporary file in the <code>R</code> temporary
folder, named <code>&lt;basename(in_rast)&gt;_sprawlmask.tif</code>. The file is saved in GTiff
format, with <code>compress</code> compression.</p></td>
    </tr>
    <tr>
      <th>out_dtype</th>
      <td><p><code>character</code> data type of the output masked files, according
to gdal specifications for GTiff files ("Byte", "UInt16", "Int16", "UInt32",
"Int32", "Float32", "Float64", "CInt16", "CInt32", "CFloat32" and "CFloat64").
If NULL, the data type is retrieved from the input, Default: NULL</p></td>
    </tr>
    <tr>
      <th>out_nodata</th>
      <td><p><code>numeric</code> value to be assigned to areas outside the mask,
Default: 'NoData'</p></td>
    </tr>
    <tr>
      <th>compress</th>
      <td><p><code>logical</code> allow verbose output from <code>foreach</code> for debugging
purposes, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p><code>logical</code> if TRUE, and out_filename is set and existing,
existing files are overwritten, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p><code>logical</code> if TRUE, use ClusterR to implement multicore
processing. This speeds up execution for large rasters, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p><code>numeric</code> Number of cores to use in case of parallel processing.
If not provided, it defaults to <code>parallel::detectCores()-2</code></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code> if TRUE, extended processing information is sent to
the console in the form of messages</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>object of class <code>raster</code> (if out_type == <code>rastobj</code>), or <code>character</code>
string corresponding to the filename of the created raster (if out_type ==
<code>filename</code>)</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>sprawl</span>)
<span class='fu'>library</span>(<span class='no'>sprawl.data</span>)
<span class='fu'>library</span>(<span class='no'>raster</span>)
<span class='no'>in_polys</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_vect.html'>read_vect</a></span>(<span class='fu'>system.file</span>(<span class='st'>"extdata/shapes"</span>,<span class='st'>"lc_polys.shp"</span>,
                                  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sprawl.data"</span>),
                       <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='no'>T</span>)
<span class='no'>in_rast</span>  <span class='kw'>&lt;-</span> <span class='kw pkg'>raster</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/stack'>stack</a></span>(<span class='fu'>system.file</span>(<span class='st'>"extdata/MODIS_test"</span>, <span class='st'>"EVIts_test.tif"</span>,
                       <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sprawl.data"</span>))<span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>in_polys</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sf</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/sf/topics/st_transform'>st_transform</a></span>(<span class='no'>in_polys</span>, <span class='fu'><a href='http://www.rdocumentation.org/packages/raster/topics/projection'>proj4string</a></span>(<span class='no'>in_rast</span>))
<span class='no'>masked</span>   <span class='kw'>&lt;-</span> <span class='fu'>mask_rast</span>(<span class='no'>in_rast</span>, <span class='no'>in_polys</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'>mask_rast --&gt; Masking: in_rast on: in_polys</span></div><div class='output co'>#&gt; <span class='message'>get_rastinfo --&gt; Retrieving info from: `in_rast`</span></div><div class='output co'>#&gt; <span class='message'>make_folder --&gt; Creating /tmp/RtmpU8rpQ0 folder</span></div><div class='output co'>#&gt; <span class='message'>make_folder --&gt; specified `path` already exists!</span></div><div class='input'><span class='fu'><a href='plot_rast.html'>plot_rast</a></span>(<span class='no'>in_rast</span>, <span class='kw'>in_poly</span> <span class='kw'>=</span> <span class='no'>in_polys</span>)</div><div class='img'><img src='mask_rast-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'><span class='fu'><a href='plot_rast.html'>plot_rast</a></span>(<span class='no'>masked</span>, <span class='kw'>in_poly</span> <span class='kw'>=</span> <span class='no'>in_polys</span>)</div><div class='img'><img src='mask_rast-2.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Lorenzo Busetto, PhD (2017) email: <a href='mailto:lbusett@gmail.com'>lbusett@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Lorenzo Busetto, Luigi Ranghetti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
