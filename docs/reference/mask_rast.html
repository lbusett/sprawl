<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mask a raster based on a vector — mask_rast • sprawl</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Mask a raster based on a vector — mask_rast" />

<meta property="og:description" content="Masks a raster file or object on the basis of a vector file or object.
Pixels not covered by the vector features are set to NoData. If the input raster
is multi-band, the mask is automatically applied to all bands. An optional
buffer can be applied to the input vector to allow a more &quot;lenient&quot; masking,
or to remove also the borders of the vector." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-3');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sprawl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sprawl.html">Getting Started</a>
</li>
<li>
  <a href="../articles/articles/examples.html">Examples of Use</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Contributing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/contributing.html">Contributing</a>
    </li>
    <li>
      <a href="../articles/articles/coding_style.html">Coding Style</a>
    </li>
    <li>
      <a href="../articles/articles/CONDUCT.html">Code of Conduct</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    faq
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    code reference
  </a>
</li>
<li>
  <a href="https://github.com/lbusett/sprawl/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mask a raster based on a vector</h1>
    <small class="dont-index">Source: <a href='https://github.com/lbusett/sprawl/blob/master/R/mask_rast.R'><code>R/mask_rast.R</code></a></small>
    <div class="hidden name"><code>mask_rast.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Masks a raster file or object on the basis of a vector file or object.
Pixels not covered by the vector features are set to NoData. If the input raster
is multi-band, the mask is automatically applied to all bands. An optional
buffer can be applied to the input vector to allow a more "lenient" masking,
or to remove also the borders of the vector.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mask_rast</span>(<span class='no'>in_rast</span>, <span class='no'>mask</span>, <span class='kw'>mask_value</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>crop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>buffer</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>out_type</span> <span class='kw'>=</span> <span class='st'>"rastobject"</span>, <span class='kw'>out_file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>out_dtype</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>out_nodata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>compress</span> <span class='kw'>=</span> <span class='st'>"None"</span>, <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>2</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>in_rast</th>
      <td><p>Raster file or object inheriting class <code>raster</code> to be masked</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><ol>
<li><p>Vector file or object of class <code>*sf</code> or <code>sp</code> to be used as a mask
2. Raster file or object of class <code>*sf</code> or <code>sp</code> to be used as a mask
NOTE: If <code>mask</code> is a raster object or file, the function checks if it has the
same number of pixels and extent of <code>in_rast</code>. If this is true, then <code>mask</code>
is used directly to mask the input. Otherwise, it is first of all vectorized
to a vector mask. The vector mask is then used in the processing.</p></li>
</ol></td>
    </tr>
    <tr>
      <th>mask_value</th>
      <td><p><code>integer</code> if <code>mask</code> is a raster object/file, value corresponding
to the areas <strong>that should be removed</strong> from the ouptut, Default: 0 (<em>Ignored if
the provided <code>mask</code> is a vector!</em>)</p></td>
    </tr>
    <tr>
      <th>crop</th>
      <td><p><code>logical</code> if TRUE, <code>in_rast</code> is also cropped on the extent of <code>mask</code>,
Default: FALSE</p></td>
    </tr>
    <tr>
      <th>buffer</th>
      <td><p><code>numeric</code> if not NULL, width of a buffer to be applied to <code>mask</code>
before masking <code>in_rast</code>. If negative, mask is "reduced" prior to masking
(see examples), Default: NULL</p></td>
    </tr>
    <tr>
      <th>out_type</th>
      <td><p><code>character</code></p><ul>
<li><p>if == "rastobj", return a <code>Raster</code> object;</p></li>
<li><p>if == "filename", return the filename of the masked layer (GTiff or gdal vrt format
depending on other arguments - see below)
Default: "rastobj" (If an invalid string is provided, defaults to <code>rastobj</code>)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>out_file</th>
      <td><p><code>character</code> filename where the masked raster should be saved
If NULL, the masked raster is saved on a temporary file in the <code>R</code> temporary
folder, named <code>&lt;basename(in_rast)&gt;_sprawlmask.tif</code>. The file is saved in GTiff
format, with <code>compress</code> compression.</p></td>
    </tr>
    <tr>
      <th>out_dtype</th>
      <td><p><code>character</code> data type of the output masked files, according
to gdal specifications for GTiff files ("Byte", "UInt16", "Int16", "UInt32",
"Int32", "Float32", "Float64", "CInt16", "CInt32", "CFloat32" and "CFloat64").
If NULL, the data type is retrieved from the input, Default: NULL</p></td>
    </tr>
    <tr>
      <th>out_nodata</th>
      <td><p><code>numeric</code> value to be assigned to areas outside the mask,
Default: NULL</p></td>
    </tr>
    <tr>
      <th>compress</th>
      <td><p><code>logical</code> allow verbose output from <code>foreach</code> for debugging
purposes, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p><code>logical</code> if TRUE, and out_file is set and existing,
existing files are overwritten, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p><code>logical</code> if TRUE, use ClusterR to implement multicore
processing. This speeds up execution for large rasters, Default: FALSE</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p><code>numeric</code> Number of cores to use in case of parallel processing.
If not provided, it defaults to <code>parallel::detectCores()-2</code></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code> if TRUE, extended processing information is sent to
the console in the form of messages</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>object of class <code>raster</code> (if out_type == <code>rastobj</code>), or <code>character</code>
string corresponding to the filename of the created raster (if out_type ==
<code>rastfile</code>)</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>sprawl</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>sprawl.data</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>raster</span>)
<span class='no'>in_polys</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_vect.html'>read_vect</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata/shapes"</span>,<span class='st'>"lc_polys.shp"</span>,
                                  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sprawl.data"</span>),
                       <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>in_rast</span>  <span class='kw'>&lt;-</span> <span class='kw pkg'>raster</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/stack'>stack</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata/MODIS_test"</span>, <span class='st'>"EVIts_test.tif"</span>,
                       <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sprawl.data"</span>))<span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>in_polys</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sf</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sf/topics/st_transform'>st_transform</a></span>(<span class='no'>in_polys</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>proj4string</a></span>(<span class='no'>in_rast</span>))
<span class='no'>masked</span>   <span class='kw'>&lt;-</span> <span class='fu'>mask_rast</span>(<span class='no'>in_rast</span>, <span class='no'>in_polys</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='plot_rast.html'>plot_rast</a></span>(<span class='no'>in_rast</span>, <span class='kw'>in_poly</span> <span class='kw'>=</span> <span class='no'>in_polys</span>)</div><div class='img'><img src='mask_rast-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='plot_rast.html'>plot_rast</a></span>(<span class='no'>masked</span>, <span class='kw'>in_poly</span> <span class='kw'>=</span> <span class='no'>in_polys</span>)</div><div class='img'><img src='mask_rast-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Lorenzo Busetto, PhD (2017) email: <a href='mailto:lbusett@gmail.com'>lbusett@gmail.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Lorenzo Busetto, Luigi Ranghetti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

